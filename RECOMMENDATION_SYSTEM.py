{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "a7191438",
   "metadata": {},
   "source": [
    "# Recommendation"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "17e19edc",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "42034ce3",
   "metadata": {},
   "outputs": [],
   "source": [
    "import numpy as np\n",
    "import pandas as pd\n",
    "import sklearn\n",
    "import seaborn as sns\n",
    "import matplotlib.pyplot as plt\n",
    "\n",
    "import sklearn\n",
    "from sklearn.feature_extraction.text import TfidfVectorizer\n",
    "from sklearn.metrics.pairwise import cosine_similarity\n",
    "from sklearn.metrics.pairwise import linear_kernel"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "4a050952",
   "metadata": {},
   "source": [
    "##  CONTENT BASED RECOMMENDATION SYSTEM"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "25d31573",
   "metadata": {},
   "source": [
    "#### Content-based filtering based on user past genre preference. "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "68e03c25",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>movieId</th>\n",
       "      <th>title</th>\n",
       "      <th>genres</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1</td>\n",
       "      <td>Toy Story (1995)</td>\n",
       "      <td>Adventure|Animation|Children|Comedy|Fantasy</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2</td>\n",
       "      <td>Jumanji (1995)</td>\n",
       "      <td>Adventure|Children|Fantasy</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>3</td>\n",
       "      <td>Grumpier Old Men (1995)</td>\n",
       "      <td>Comedy|Romance</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>4</td>\n",
       "      <td>Waiting to Exhale (1995)</td>\n",
       "      <td>Comedy|Drama|Romance</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>5</td>\n",
       "      <td>Father of the Bride Part II (1995)</td>\n",
       "      <td>Comedy</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10324</th>\n",
       "      <td>146684</td>\n",
       "      <td>Cosmic Scrat-tastrophe (2015)</td>\n",
       "      <td>Animation|Children|Comedy</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10325</th>\n",
       "      <td>146878</td>\n",
       "      <td>Le Grand Restaurant (1966)</td>\n",
       "      <td>Comedy</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10326</th>\n",
       "      <td>148238</td>\n",
       "      <td>A Very Murray Christmas (2015)</td>\n",
       "      <td>Comedy</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10327</th>\n",
       "      <td>148626</td>\n",
       "      <td>The Big Short (2015)</td>\n",
       "      <td>Drama</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10328</th>\n",
       "      <td>149532</td>\n",
       "      <td>Marco Polo: One Hundred Eyes (2015)</td>\n",
       "      <td>(no genres listed)</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>10329 rows × 3 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "       movieId                                title  \\\n",
       "0            1                     Toy Story (1995)   \n",
       "1            2                       Jumanji (1995)   \n",
       "2            3              Grumpier Old Men (1995)   \n",
       "3            4             Waiting to Exhale (1995)   \n",
       "4            5   Father of the Bride Part II (1995)   \n",
       "...        ...                                  ...   \n",
       "10324   146684        Cosmic Scrat-tastrophe (2015)   \n",
       "10325   146878           Le Grand Restaurant (1966)   \n",
       "10326   148238       A Very Murray Christmas (2015)   \n",
       "10327   148626                 The Big Short (2015)   \n",
       "10328   149532  Marco Polo: One Hundred Eyes (2015)   \n",
       "\n",
       "                                            genres  \n",
       "0      Adventure|Animation|Children|Comedy|Fantasy  \n",
       "1                       Adventure|Children|Fantasy  \n",
       "2                                   Comedy|Romance  \n",
       "3                             Comedy|Drama|Romance  \n",
       "4                                           Comedy  \n",
       "...                                            ...  \n",
       "10324                    Animation|Children|Comedy  \n",
       "10325                                       Comedy  \n",
       "10326                                       Comedy  \n",
       "10327                                        Drama  \n",
       "10328                           (no genres listed)  \n",
       "\n",
       "[10329 rows x 3 columns]"
      ]
     },
     "execution_count": 10,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "movies = pd.read_csv('movies.csv')\n",
    "ratings = pd.read_csv('ratings.csv')\n",
    "movies"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 33,
   "id": "e0bf2e56",
   "metadata": {},
   "outputs": [],
   "source": [
    "movies.columns=['MoiveId', 'Title', 'Genres']\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 35,
   "id": "dc12f004",
   "metadata": {},
   "outputs": [],
   "source": [
    "count2 = movies.loc[movies['Genres'] == 'Adventure'].count()[0]\n",
    "count1 = movies.loc[movies['Genres'] == 'Comedy'].count()[0]\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 36,
   "id": "987a276e",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>MovieId</th>\n",
       "      <th>Title</th>\n",
       "      <th>Genres</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1</td>\n",
       "      <td>Toy Story (1995)</td>\n",
       "      <td>Adventure|Animation|Children|Comedy|Fantasy</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2</td>\n",
       "      <td>Jumanji (1995)</td>\n",
       "      <td>Adventure|Children|Fantasy</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>3</td>\n",
       "      <td>Grumpier Old Men (1995)</td>\n",
       "      <td>Comedy|Romance</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>4</td>\n",
       "      <td>Waiting to Exhale (1995)</td>\n",
       "      <td>Comedy|Drama|Romance</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>5</td>\n",
       "      <td>Father of the Bride Part II (1995)</td>\n",
       "      <td>Comedy</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10324</th>\n",
       "      <td>146684</td>\n",
       "      <td>Cosmic Scrat-tastrophe (2015)</td>\n",
       "      <td>Animation|Children|Comedy</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10325</th>\n",
       "      <td>146878</td>\n",
       "      <td>Le Grand Restaurant (1966)</td>\n",
       "      <td>Comedy</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10326</th>\n",
       "      <td>148238</td>\n",
       "      <td>A Very Murray Christmas (2015)</td>\n",
       "      <td>Comedy</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10327</th>\n",
       "      <td>148626</td>\n",
       "      <td>The Big Short (2015)</td>\n",
       "      <td>Drama</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10328</th>\n",
       "      <td>149532</td>\n",
       "      <td>Marco Polo: One Hundred Eyes (2015)</td>\n",
       "      <td>(no genres listed)</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>10329 rows × 3 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "       MovieId                                Title  \\\n",
       "0            1                     Toy Story (1995)   \n",
       "1            2                       Jumanji (1995)   \n",
       "2            3              Grumpier Old Men (1995)   \n",
       "3            4             Waiting to Exhale (1995)   \n",
       "4            5   Father of the Bride Part II (1995)   \n",
       "...        ...                                  ...   \n",
       "10324   146684        Cosmic Scrat-tastrophe (2015)   \n",
       "10325   146878           Le Grand Restaurant (1966)   \n",
       "10326   148238       A Very Murray Christmas (2015)   \n",
       "10327   148626                 The Big Short (2015)   \n",
       "10328   149532  Marco Polo: One Hundred Eyes (2015)   \n",
       "\n",
       "                                            Genres  \n",
       "0      Adventure|Animation|Children|Comedy|Fantasy  \n",
       "1                       Adventure|Children|Fantasy  \n",
       "2                                   Comedy|Romance  \n",
       "3                             Comedy|Drama|Romance  \n",
       "4                                           Comedy  \n",
       "...                                            ...  \n",
       "10324                    Animation|Children|Comedy  \n",
       "10325                                       Comedy  \n",
       "10326                                       Comedy  \n",
       "10327                                        Drama  \n",
       "10328                           (no genres listed)  \n",
       "\n",
       "[10329 rows x 3 columns]"
      ]
     },
     "execution_count": 36,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "movies.fillna(value='0')\n",
    "movies.columns = ['MovieId', 'Title', 'Genres']\n",
    "movies"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 37,
   "id": "73eb35c9",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0        Adventure|Animation|Children|Comedy|Fantasy\n",
       "1                         Adventure|Children|Fantasy\n",
       "2                                     Comedy|Romance\n",
       "3                               Comedy|Drama|Romance\n",
       "4                                             Comedy\n",
       "                            ...                     \n",
       "10324                      Animation|Children|Comedy\n",
       "10325                                         Comedy\n",
       "10326                                         Comedy\n",
       "10327                                          Drama\n",
       "10328                             (no genres listed)\n",
       "Name: Genres, Length: 10329, dtype: object"
      ]
     },
     "execution_count": 37,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "movies['Genres']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 38,
   "id": "e94f6e6d",
   "metadata": {},
   "outputs": [],
   "source": [
    "tfidf = TfidfVectorizer(stop_words='english')\n",
    "movies['Genres'] = movies['Genres'].fillna(\"\")\n",
    "tfidf_matrix = tfidf.fit_transform(movies['Genres'],  )"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 39,
   "id": "cd6d0ab3",
   "metadata": {},
   "outputs": [],
   "source": [
    " cosine_sim = linear_kernel(tfidf_matrix, tfidf_matrix)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "a8869afc",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": 40,
   "id": "3b48acff",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Title\n",
       "Toy Story (1995)                           0\n",
       "Jumanji (1995)                             1\n",
       "Grumpier Old Men (1995)                    2\n",
       "Waiting to Exhale (1995)                   3\n",
       "Father of the Bride Part II (1995)         4\n",
       "                                       ...  \n",
       "Cosmic Scrat-tastrophe (2015)          10324\n",
       "Le Grand Restaurant (1966)             10325\n",
       "A Very Murray Christmas (2015)         10326\n",
       "The Big Short (2015)                   10327\n",
       "Marco Polo: One Hundred Eyes (2015)    10328\n",
       "Length: 10329, dtype: int64"
      ]
     },
     "execution_count": 40,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "indices = pd.Series(movies.index, index= movies['Title']).drop_duplicates()\n",
    "indices"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 41,
   "id": "b0957d9b",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "1"
      ]
     },
     "execution_count": 41,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "indices['Jumanji (1995)']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 42,
   "id": "698fb760",
   "metadata": {},
   "outputs": [],
   "source": [
    "def get_recommendations(title, cosine_sim = cosine_sim):\n",
    "    idx = indices[title]\n",
    "    sim_scores = enumerate(cosine_sim[idx])\n",
    "    sim_scores = sorted(sim_scores, key = lambda x: x[1], reverse=True)\n",
    "    sim_scores= sim_scores[1:11]\n",
    "  \n",
    "  \n",
    "    sim_index = [i[0] for i in sim_scores]\n",
    "    print(movies[\"Title\"].iloc[sim_index])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 43,
   "id": "6b060bfb",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "55                     Indian in the Cupboard, The (1995)\n",
      "112                     NeverEnding Story III, The (1994)\n",
      "817                       Escape to Witch Mountain (1975)\n",
      "1604            Darby O'Gill and the Little People (1959)\n",
      "1652                                  Return to Oz (1985)\n",
      "1716                        NeverEnding Story, The (1984)\n",
      "1717    NeverEnding Story II: The Next Chapter, The (1...\n",
      "1908                        Santa Claus: The Movie (1985)\n",
      "3817    Harry Potter and the Sorcerer's Stone (a.k.a. ...\n",
      "6471                            Magic in the Water (1995)\n",
      "Name: Title, dtype: object\n"
     ]
    }
   ],
   "source": [
    "get_recommendations('Jumanji (1995)')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "591666ee",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "9611f3b3",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "markdown",
   "id": "b842c034",
   "metadata": {},
   "source": [
    "## COLLABORATIVE FITERING \n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "92d7b94e",
   "metadata": {},
   "source": [
    "#### Collaborative filtering using cosine similarities between users movie interest and rating they awarded each movie of various to provide recommendations. "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 44,
   "id": "29b5558d",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>userId</th>\n",
       "      <th>MovieId</th>\n",
       "      <th>rating</th>\n",
       "      <th>timestamp</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1</td>\n",
       "      <td>16</td>\n",
       "      <td>4.0</td>\n",
       "      <td>1217897793</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1</td>\n",
       "      <td>24</td>\n",
       "      <td>1.5</td>\n",
       "      <td>1217895807</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>1</td>\n",
       "      <td>32</td>\n",
       "      <td>4.0</td>\n",
       "      <td>1217896246</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>1</td>\n",
       "      <td>47</td>\n",
       "      <td>4.0</td>\n",
       "      <td>1217896556</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>1</td>\n",
       "      <td>50</td>\n",
       "      <td>4.0</td>\n",
       "      <td>1217896523</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>105334</th>\n",
       "      <td>668</td>\n",
       "      <td>142488</td>\n",
       "      <td>4.0</td>\n",
       "      <td>1451535844</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>105335</th>\n",
       "      <td>668</td>\n",
       "      <td>142507</td>\n",
       "      <td>3.5</td>\n",
       "      <td>1451535889</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>105336</th>\n",
       "      <td>668</td>\n",
       "      <td>143385</td>\n",
       "      <td>4.0</td>\n",
       "      <td>1446388585</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>105337</th>\n",
       "      <td>668</td>\n",
       "      <td>144976</td>\n",
       "      <td>2.5</td>\n",
       "      <td>1448656898</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>105338</th>\n",
       "      <td>668</td>\n",
       "      <td>148626</td>\n",
       "      <td>4.5</td>\n",
       "      <td>1451148148</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>105339 rows × 4 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "        userId  MovieId  rating   timestamp\n",
       "0            1       16     4.0  1217897793\n",
       "1            1       24     1.5  1217895807\n",
       "2            1       32     4.0  1217896246\n",
       "3            1       47     4.0  1217896556\n",
       "4            1       50     4.0  1217896523\n",
       "...        ...      ...     ...         ...\n",
       "105334     668   142488     4.0  1451535844\n",
       "105335     668   142507     3.5  1451535889\n",
       "105336     668   143385     4.0  1446388585\n",
       "105337     668   144976     2.5  1448656898\n",
       "105338     668   148626     4.5  1451148148\n",
       "\n",
       "[105339 rows x 4 columns]"
      ]
     },
     "execution_count": 44,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "ratings.columns = ['userId', 'MovieId', 'rating', 'timestamp']\n",
    "ratings"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 45,
   "id": "7bb6f081",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>userId</th>\n",
       "      <th>MovieId</th>\n",
       "      <th>rating</th>\n",
       "      <th>timestamp</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1</td>\n",
       "      <td>16</td>\n",
       "      <td>4.0</td>\n",
       "      <td>1217897793</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1</td>\n",
       "      <td>24</td>\n",
       "      <td>1.5</td>\n",
       "      <td>1217895807</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>1</td>\n",
       "      <td>32</td>\n",
       "      <td>4.0</td>\n",
       "      <td>1217896246</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>1</td>\n",
       "      <td>47</td>\n",
       "      <td>4.0</td>\n",
       "      <td>1217896556</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>1</td>\n",
       "      <td>50</td>\n",
       "      <td>4.0</td>\n",
       "      <td>1217896523</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>105334</th>\n",
       "      <td>668</td>\n",
       "      <td>142488</td>\n",
       "      <td>4.0</td>\n",
       "      <td>1451535844</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>105335</th>\n",
       "      <td>668</td>\n",
       "      <td>142507</td>\n",
       "      <td>3.5</td>\n",
       "      <td>1451535889</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>105336</th>\n",
       "      <td>668</td>\n",
       "      <td>143385</td>\n",
       "      <td>4.0</td>\n",
       "      <td>1446388585</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>105337</th>\n",
       "      <td>668</td>\n",
       "      <td>144976</td>\n",
       "      <td>2.5</td>\n",
       "      <td>1448656898</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>105338</th>\n",
       "      <td>668</td>\n",
       "      <td>148626</td>\n",
       "      <td>4.5</td>\n",
       "      <td>1451148148</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>105339 rows × 4 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "        userId  MovieId  rating   timestamp\n",
       "0            1       16     4.0  1217897793\n",
       "1            1       24     1.5  1217895807\n",
       "2            1       32     4.0  1217896246\n",
       "3            1       47     4.0  1217896556\n",
       "4            1       50     4.0  1217896523\n",
       "...        ...      ...     ...         ...\n",
       "105334     668   142488     4.0  1451535844\n",
       "105335     668   142507     3.5  1451535889\n",
       "105336     668   143385     4.0  1446388585\n",
       "105337     668   144976     2.5  1448656898\n",
       "105338     668   148626     4.5  1451148148\n",
       "\n",
       "[105339 rows x 4 columns]"
      ]
     },
     "execution_count": 45,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "movies[['MovieId', 'Title', 'Genres']]\n",
    "ratings[['userId', 'MovieId', 'rating', 'timestamp']]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 59,
   "id": "bf016c90",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>userId</th>\n",
       "      <th>MovieId</th>\n",
       "      <th>rating</th>\n",
       "      <th>timestamp</th>\n",
       "      <th>Title</th>\n",
       "      <th>Genres</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1</td>\n",
       "      <td>16</td>\n",
       "      <td>4.0</td>\n",
       "      <td>1217897793</td>\n",
       "      <td>Casino (1995)</td>\n",
       "      <td>Crime|Drama</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1</td>\n",
       "      <td>24</td>\n",
       "      <td>1.5</td>\n",
       "      <td>1217895807</td>\n",
       "      <td>Powder (1995)</td>\n",
       "      <td>Drama|Sci-Fi</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>1</td>\n",
       "      <td>32</td>\n",
       "      <td>4.0</td>\n",
       "      <td>1217896246</td>\n",
       "      <td>Twelve Monkeys (a.k.a. 12 Monkeys) (1995)</td>\n",
       "      <td>Mystery|Sci-Fi|Thriller</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>1</td>\n",
       "      <td>47</td>\n",
       "      <td>4.0</td>\n",
       "      <td>1217896556</td>\n",
       "      <td>Seven (a.k.a. Se7en) (1995)</td>\n",
       "      <td>Mystery|Thriller</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>1</td>\n",
       "      <td>50</td>\n",
       "      <td>4.0</td>\n",
       "      <td>1217896523</td>\n",
       "      <td>Usual Suspects, The (1995)</td>\n",
       "      <td>Crime|Mystery|Thriller</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>1</td>\n",
       "      <td>110</td>\n",
       "      <td>4.0</td>\n",
       "      <td>1217896150</td>\n",
       "      <td>Braveheart (1995)</td>\n",
       "      <td>Action|Drama|War</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>1</td>\n",
       "      <td>150</td>\n",
       "      <td>3.0</td>\n",
       "      <td>1217895940</td>\n",
       "      <td>Apollo 13 (1995)</td>\n",
       "      <td>Adventure|Drama|IMAX</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>1</td>\n",
       "      <td>161</td>\n",
       "      <td>4.0</td>\n",
       "      <td>1217897864</td>\n",
       "      <td>Crimson Tide (1995)</td>\n",
       "      <td>Drama|Thriller|War</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>1</td>\n",
       "      <td>165</td>\n",
       "      <td>3.0</td>\n",
       "      <td>1217897135</td>\n",
       "      <td>Die Hard: With a Vengeance (1995)</td>\n",
       "      <td>Action|Crime|Thriller</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>1</td>\n",
       "      <td>204</td>\n",
       "      <td>0.5</td>\n",
       "      <td>1217895786</td>\n",
       "      <td>Under Siege 2: Dark Territory (1995)</td>\n",
       "      <td>Action</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>1</td>\n",
       "      <td>223</td>\n",
       "      <td>4.0</td>\n",
       "      <td>1217897795</td>\n",
       "      <td>Clerks (1994)</td>\n",
       "      <td>Comedy</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>1</td>\n",
       "      <td>256</td>\n",
       "      <td>0.5</td>\n",
       "      <td>1217895764</td>\n",
       "      <td>Junior (1994)</td>\n",
       "      <td>Comedy|Sci-Fi</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>1</td>\n",
       "      <td>260</td>\n",
       "      <td>4.5</td>\n",
       "      <td>1217895864</td>\n",
       "      <td>Star Wars: Episode IV - A New Hope (1977)</td>\n",
       "      <td>Action|Adventure|Sci-Fi</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>1</td>\n",
       "      <td>261</td>\n",
       "      <td>1.5</td>\n",
       "      <td>1217895750</td>\n",
       "      <td>Little Women (1994)</td>\n",
       "      <td>Drama</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>1</td>\n",
       "      <td>277</td>\n",
       "      <td>0.5</td>\n",
       "      <td>1217895772</td>\n",
       "      <td>Miracle on 34th Street (1994)</td>\n",
       "      <td>Drama</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>1</td>\n",
       "      <td>296</td>\n",
       "      <td>4.0</td>\n",
       "      <td>1217896125</td>\n",
       "      <td>Pulp Fiction (1994)</td>\n",
       "      <td>Comedy|Crime|Drama|Thriller</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>1</td>\n",
       "      <td>318</td>\n",
       "      <td>4.0</td>\n",
       "      <td>1217895860</td>\n",
       "      <td>Shawshank Redemption, The (1994)</td>\n",
       "      <td>Crime|Drama</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>1</td>\n",
       "      <td>349</td>\n",
       "      <td>4.5</td>\n",
       "      <td>1217897058</td>\n",
       "      <td>Clear and Present Danger (1994)</td>\n",
       "      <td>Action|Crime|Drama|Thriller</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>1</td>\n",
       "      <td>356</td>\n",
       "      <td>3.0</td>\n",
       "      <td>1217896231</td>\n",
       "      <td>Forrest Gump (1994)</td>\n",
       "      <td>Comedy|Drama|Romance|War</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>1</td>\n",
       "      <td>377</td>\n",
       "      <td>2.5</td>\n",
       "      <td>1217896373</td>\n",
       "      <td>Speed (1994)</td>\n",
       "      <td>Action|Romance|Thriller</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20</th>\n",
       "      <td>1</td>\n",
       "      <td>380</td>\n",
       "      <td>3.0</td>\n",
       "      <td>1217896030</td>\n",
       "      <td>True Lies (1994)</td>\n",
       "      <td>Action|Adventure|Comedy|Romance|Thriller</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21</th>\n",
       "      <td>1</td>\n",
       "      <td>457</td>\n",
       "      <td>4.0</td>\n",
       "      <td>1217896015</td>\n",
       "      <td>Fugitive, The (1993)</td>\n",
       "      <td>Thriller</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>22</th>\n",
       "      <td>1</td>\n",
       "      <td>480</td>\n",
       "      <td>3.5</td>\n",
       "      <td>1217895972</td>\n",
       "      <td>Jurassic Park (1993)</td>\n",
       "      <td>Action|Adventure|Sci-Fi|Thriller</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>23</th>\n",
       "      <td>1</td>\n",
       "      <td>527</td>\n",
       "      <td>4.5</td>\n",
       "      <td>1217896341</td>\n",
       "      <td>Schindler's List (1993)</td>\n",
       "      <td>Drama|War</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24</th>\n",
       "      <td>1</td>\n",
       "      <td>589</td>\n",
       "      <td>3.5</td>\n",
       "      <td>1217896078</td>\n",
       "      <td>Terminator 2: Judgment Day (1991)</td>\n",
       "      <td>Action|Sci-Fi</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25</th>\n",
       "      <td>1</td>\n",
       "      <td>590</td>\n",
       "      <td>3.5</td>\n",
       "      <td>1217896038</td>\n",
       "      <td>Dances with Wolves (1990)</td>\n",
       "      <td>Adventure|Drama|Western</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>26</th>\n",
       "      <td>1</td>\n",
       "      <td>592</td>\n",
       "      <td>2.5</td>\n",
       "      <td>1217896043</td>\n",
       "      <td>Batman (1989)</td>\n",
       "      <td>Action|Crime|Thriller</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>27</th>\n",
       "      <td>1</td>\n",
       "      <td>593</td>\n",
       "      <td>5.0</td>\n",
       "      <td>1217895932</td>\n",
       "      <td>Silence of the Lambs, The (1991)</td>\n",
       "      <td>Crime|Horror|Thriller</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>28</th>\n",
       "      <td>1</td>\n",
       "      <td>597</td>\n",
       "      <td>3.0</td>\n",
       "      <td>1217897176</td>\n",
       "      <td>Pretty Woman (1990)</td>\n",
       "      <td>Comedy|Romance</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>29</th>\n",
       "      <td>1</td>\n",
       "      <td>608</td>\n",
       "      <td>3.5</td>\n",
       "      <td>1217896319</td>\n",
       "      <td>Fargo (1996)</td>\n",
       "      <td>Comedy|Crime|Drama|Thriller</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>30</th>\n",
       "      <td>1</td>\n",
       "      <td>648</td>\n",
       "      <td>3.5</td>\n",
       "      <td>1217896397</td>\n",
       "      <td>Mission: Impossible (1996)</td>\n",
       "      <td>Action|Adventure|Mystery|Thriller</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>31</th>\n",
       "      <td>1</td>\n",
       "      <td>719</td>\n",
       "      <td>0.5</td>\n",
       "      <td>1217895799</td>\n",
       "      <td>Multiplicity (1996)</td>\n",
       "      <td>Comedy</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>32</th>\n",
       "      <td>1</td>\n",
       "      <td>724</td>\n",
       "      <td>3.5</td>\n",
       "      <td>1217895794</td>\n",
       "      <td>Craft, The (1996)</td>\n",
       "      <td>Drama|Fantasy|Horror|Thriller</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>33</th>\n",
       "      <td>1</td>\n",
       "      <td>736</td>\n",
       "      <td>3.0</td>\n",
       "      <td>1217896621</td>\n",
       "      <td>Twister (1996)</td>\n",
       "      <td>Action|Adventure|Romance|Thriller</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>34</th>\n",
       "      <td>1</td>\n",
       "      <td>780</td>\n",
       "      <td>3.5</td>\n",
       "      <td>1217895969</td>\n",
       "      <td>Independence Day (a.k.a. ID4) (1996)</td>\n",
       "      <td>Action|Adventure|Sci-Fi|Thriller</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>35</th>\n",
       "      <td>1</td>\n",
       "      <td>858</td>\n",
       "      <td>5.0</td>\n",
       "      <td>1217896428</td>\n",
       "      <td>Godfather, The (1972)</td>\n",
       "      <td>Crime|Drama</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>36</th>\n",
       "      <td>1</td>\n",
       "      <td>912</td>\n",
       "      <td>5.0</td>\n",
       "      <td>1217897623</td>\n",
       "      <td>Casablanca (1942)</td>\n",
       "      <td>Drama|Romance</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>37</th>\n",
       "      <td>1</td>\n",
       "      <td>968</td>\n",
       "      <td>4.5</td>\n",
       "      <td>1217897263</td>\n",
       "      <td>Night of the Living Dead (1968)</td>\n",
       "      <td>Horror|Sci-Fi|Thriller</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>38</th>\n",
       "      <td>1</td>\n",
       "      <td>1061</td>\n",
       "      <td>4.0</td>\n",
       "      <td>1217895811</td>\n",
       "      <td>Sleepers (1996)</td>\n",
       "      <td>Thriller</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>39</th>\n",
       "      <td>1</td>\n",
       "      <td>1089</td>\n",
       "      <td>4.5</td>\n",
       "      <td>1217897621</td>\n",
       "      <td>Reservoir Dogs (1992)</td>\n",
       "      <td>Crime|Mystery|Thriller</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>40</th>\n",
       "      <td>1</td>\n",
       "      <td>1136</td>\n",
       "      <td>5.0</td>\n",
       "      <td>1217897630</td>\n",
       "      <td>Monty Python and the Holy Grail (1975)</td>\n",
       "      <td>Adventure|Comedy|Fantasy</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>41</th>\n",
       "      <td>1</td>\n",
       "      <td>1196</td>\n",
       "      <td>4.5</td>\n",
       "      <td>1217896095</td>\n",
       "      <td>Star Wars: Episode V - The Empire Strikes Back...</td>\n",
       "      <td>Action|Adventure|Sci-Fi</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>42</th>\n",
       "      <td>1</td>\n",
       "      <td>1198</td>\n",
       "      <td>4.0</td>\n",
       "      <td>1217896450</td>\n",
       "      <td>Raiders of the Lost Ark (Indiana Jones and the...</td>\n",
       "      <td>Action|Adventure</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>43</th>\n",
       "      <td>1</td>\n",
       "      <td>1210</td>\n",
       "      <td>4.5</td>\n",
       "      <td>1217895912</td>\n",
       "      <td>Star Wars: Episode VI - Return of the Jedi (1983)</td>\n",
       "      <td>Action|Adventure|Sci-Fi</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>44</th>\n",
       "      <td>1</td>\n",
       "      <td>1213</td>\n",
       "      <td>5.0</td>\n",
       "      <td>1217897617</td>\n",
       "      <td>Goodfellas (1990)</td>\n",
       "      <td>Crime|Drama</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>45</th>\n",
       "      <td>1</td>\n",
       "      <td>1220</td>\n",
       "      <td>4.0</td>\n",
       "      <td>1217897823</td>\n",
       "      <td>Blues Brothers, The (1980)</td>\n",
       "      <td>Action|Comedy|Musical</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>46</th>\n",
       "      <td>1</td>\n",
       "      <td>1221</td>\n",
       "      <td>5.0</td>\n",
       "      <td>1217897613</td>\n",
       "      <td>Godfather: Part II, The (1974)</td>\n",
       "      <td>Crime|Drama</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>47</th>\n",
       "      <td>1</td>\n",
       "      <td>1222</td>\n",
       "      <td>5.0</td>\n",
       "      <td>1217897625</td>\n",
       "      <td>Full Metal Jacket (1987)</td>\n",
       "      <td>Drama|War</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>48</th>\n",
       "      <td>1</td>\n",
       "      <td>1233</td>\n",
       "      <td>4.5</td>\n",
       "      <td>1217897648</td>\n",
       "      <td>Boot, Das (Boat, The) (1981)</td>\n",
       "      <td>Action|Drama|War</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>49</th>\n",
       "      <td>1</td>\n",
       "      <td>1243</td>\n",
       "      <td>3.5</td>\n",
       "      <td>1217897427</td>\n",
       "      <td>Rosencrantz and Guildenstern Are Dead (1990)</td>\n",
       "      <td>Comedy|Drama</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "    userId  MovieId  rating   timestamp  \\\n",
       "0        1       16     4.0  1217897793   \n",
       "1        1       24     1.5  1217895807   \n",
       "2        1       32     4.0  1217896246   \n",
       "3        1       47     4.0  1217896556   \n",
       "4        1       50     4.0  1217896523   \n",
       "5        1      110     4.0  1217896150   \n",
       "6        1      150     3.0  1217895940   \n",
       "7        1      161     4.0  1217897864   \n",
       "8        1      165     3.0  1217897135   \n",
       "9        1      204     0.5  1217895786   \n",
       "10       1      223     4.0  1217897795   \n",
       "11       1      256     0.5  1217895764   \n",
       "12       1      260     4.5  1217895864   \n",
       "13       1      261     1.5  1217895750   \n",
       "14       1      277     0.5  1217895772   \n",
       "15       1      296     4.0  1217896125   \n",
       "16       1      318     4.0  1217895860   \n",
       "17       1      349     4.5  1217897058   \n",
       "18       1      356     3.0  1217896231   \n",
       "19       1      377     2.5  1217896373   \n",
       "20       1      380     3.0  1217896030   \n",
       "21       1      457     4.0  1217896015   \n",
       "22       1      480     3.5  1217895972   \n",
       "23       1      527     4.5  1217896341   \n",
       "24       1      589     3.5  1217896078   \n",
       "25       1      590     3.5  1217896038   \n",
       "26       1      592     2.5  1217896043   \n",
       "27       1      593     5.0  1217895932   \n",
       "28       1      597     3.0  1217897176   \n",
       "29       1      608     3.5  1217896319   \n",
       "30       1      648     3.5  1217896397   \n",
       "31       1      719     0.5  1217895799   \n",
       "32       1      724     3.5  1217895794   \n",
       "33       1      736     3.0  1217896621   \n",
       "34       1      780     3.5  1217895969   \n",
       "35       1      858     5.0  1217896428   \n",
       "36       1      912     5.0  1217897623   \n",
       "37       1      968     4.5  1217897263   \n",
       "38       1     1061     4.0  1217895811   \n",
       "39       1     1089     4.5  1217897621   \n",
       "40       1     1136     5.0  1217897630   \n",
       "41       1     1196     4.5  1217896095   \n",
       "42       1     1198     4.0  1217896450   \n",
       "43       1     1210     4.5  1217895912   \n",
       "44       1     1213     5.0  1217897617   \n",
       "45       1     1220     4.0  1217897823   \n",
       "46       1     1221     5.0  1217897613   \n",
       "47       1     1222     5.0  1217897625   \n",
       "48       1     1233     4.5  1217897648   \n",
       "49       1     1243     3.5  1217897427   \n",
       "\n",
       "                                                Title  \\\n",
       "0                                       Casino (1995)   \n",
       "1                                       Powder (1995)   \n",
       "2           Twelve Monkeys (a.k.a. 12 Monkeys) (1995)   \n",
       "3                         Seven (a.k.a. Se7en) (1995)   \n",
       "4                          Usual Suspects, The (1995)   \n",
       "5                                   Braveheart (1995)   \n",
       "6                                    Apollo 13 (1995)   \n",
       "7                                 Crimson Tide (1995)   \n",
       "8                   Die Hard: With a Vengeance (1995)   \n",
       "9                Under Siege 2: Dark Territory (1995)   \n",
       "10                                      Clerks (1994)   \n",
       "11                                      Junior (1994)   \n",
       "12          Star Wars: Episode IV - A New Hope (1977)   \n",
       "13                                Little Women (1994)   \n",
       "14                      Miracle on 34th Street (1994)   \n",
       "15                                Pulp Fiction (1994)   \n",
       "16                   Shawshank Redemption, The (1994)   \n",
       "17                    Clear and Present Danger (1994)   \n",
       "18                                Forrest Gump (1994)   \n",
       "19                                       Speed (1994)   \n",
       "20                                   True Lies (1994)   \n",
       "21                               Fugitive, The (1993)   \n",
       "22                               Jurassic Park (1993)   \n",
       "23                            Schindler's List (1993)   \n",
       "24                  Terminator 2: Judgment Day (1991)   \n",
       "25                          Dances with Wolves (1990)   \n",
       "26                                      Batman (1989)   \n",
       "27                   Silence of the Lambs, The (1991)   \n",
       "28                                Pretty Woman (1990)   \n",
       "29                                       Fargo (1996)   \n",
       "30                         Mission: Impossible (1996)   \n",
       "31                                Multiplicity (1996)   \n",
       "32                                  Craft, The (1996)   \n",
       "33                                     Twister (1996)   \n",
       "34               Independence Day (a.k.a. ID4) (1996)   \n",
       "35                              Godfather, The (1972)   \n",
       "36                                  Casablanca (1942)   \n",
       "37                    Night of the Living Dead (1968)   \n",
       "38                                    Sleepers (1996)   \n",
       "39                              Reservoir Dogs (1992)   \n",
       "40             Monty Python and the Holy Grail (1975)   \n",
       "41  Star Wars: Episode V - The Empire Strikes Back...   \n",
       "42  Raiders of the Lost Ark (Indiana Jones and the...   \n",
       "43  Star Wars: Episode VI - Return of the Jedi (1983)   \n",
       "44                                  Goodfellas (1990)   \n",
       "45                         Blues Brothers, The (1980)   \n",
       "46                     Godfather: Part II, The (1974)   \n",
       "47                           Full Metal Jacket (1987)   \n",
       "48                       Boot, Das (Boat, The) (1981)   \n",
       "49       Rosencrantz and Guildenstern Are Dead (1990)   \n",
       "\n",
       "                                      Genres  \n",
       "0                                Crime|Drama  \n",
       "1                               Drama|Sci-Fi  \n",
       "2                    Mystery|Sci-Fi|Thriller  \n",
       "3                           Mystery|Thriller  \n",
       "4                     Crime|Mystery|Thriller  \n",
       "5                           Action|Drama|War  \n",
       "6                       Adventure|Drama|IMAX  \n",
       "7                         Drama|Thriller|War  \n",
       "8                      Action|Crime|Thriller  \n",
       "9                                     Action  \n",
       "10                                    Comedy  \n",
       "11                             Comedy|Sci-Fi  \n",
       "12                   Action|Adventure|Sci-Fi  \n",
       "13                                     Drama  \n",
       "14                                     Drama  \n",
       "15               Comedy|Crime|Drama|Thriller  \n",
       "16                               Crime|Drama  \n",
       "17               Action|Crime|Drama|Thriller  \n",
       "18                  Comedy|Drama|Romance|War  \n",
       "19                   Action|Romance|Thriller  \n",
       "20  Action|Adventure|Comedy|Romance|Thriller  \n",
       "21                                  Thriller  \n",
       "22          Action|Adventure|Sci-Fi|Thriller  \n",
       "23                                 Drama|War  \n",
       "24                             Action|Sci-Fi  \n",
       "25                   Adventure|Drama|Western  \n",
       "26                     Action|Crime|Thriller  \n",
       "27                     Crime|Horror|Thriller  \n",
       "28                            Comedy|Romance  \n",
       "29               Comedy|Crime|Drama|Thriller  \n",
       "30         Action|Adventure|Mystery|Thriller  \n",
       "31                                    Comedy  \n",
       "32             Drama|Fantasy|Horror|Thriller  \n",
       "33         Action|Adventure|Romance|Thriller  \n",
       "34          Action|Adventure|Sci-Fi|Thriller  \n",
       "35                               Crime|Drama  \n",
       "36                             Drama|Romance  \n",
       "37                    Horror|Sci-Fi|Thriller  \n",
       "38                                  Thriller  \n",
       "39                    Crime|Mystery|Thriller  \n",
       "40                  Adventure|Comedy|Fantasy  \n",
       "41                   Action|Adventure|Sci-Fi  \n",
       "42                          Action|Adventure  \n",
       "43                   Action|Adventure|Sci-Fi  \n",
       "44                               Crime|Drama  \n",
       "45                     Action|Comedy|Musical  \n",
       "46                               Crime|Drama  \n",
       "47                                 Drama|War  \n",
       "48                          Action|Drama|War  \n",
       "49                              Comedy|Drama  "
      ]
     },
     "execution_count": 59,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "rating_jn = pd.merge(ratings, movies, how='left', on='MovieId')\n",
    "rating_jn.head(50)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "d0003c5d",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": 60,
   "id": "f9f6ffc0",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th>Title</th>\n",
       "      <th>'71 (2014)</th>\n",
       "      <th>'Hellboy': The Seeds of Creation (2004)</th>\n",
       "      <th>'Round Midnight (1986)</th>\n",
       "      <th>'Til There Was You (1997)</th>\n",
       "      <th>'burbs, The (1989)</th>\n",
       "      <th>'night Mother (1986)</th>\n",
       "      <th>(500) Days of Summer (2009)</th>\n",
       "      <th>*batteries not included (1987)</th>\n",
       "      <th>...And Justice for All (1979)</th>\n",
       "      <th>10 (1979)</th>\n",
       "      <th>...</th>\n",
       "      <th>[REC] (2007)</th>\n",
       "      <th>[REC]² (2009)</th>\n",
       "      <th>[REC]³ 3 Génesis (2012)</th>\n",
       "      <th>a/k/a Tommy Chong (2005)</th>\n",
       "      <th>eXistenZ (1999)</th>\n",
       "      <th>loudQUIETloud: A Film About the Pixies (2006)</th>\n",
       "      <th>xXx (2002)</th>\n",
       "      <th>xXx: State of the Union (2005)</th>\n",
       "      <th>¡Three Amigos! (1986)</th>\n",
       "      <th>À nous la liberté (Freedom for Us) (1931)</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>userId</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows × 10323 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "Title   '71 (2014)  'Hellboy': The Seeds of Creation (2004)  \\\n",
       "userId                                                        \n",
       "1              NaN                                      NaN   \n",
       "2              NaN                                      NaN   \n",
       "3              NaN                                      NaN   \n",
       "4              NaN                                      NaN   \n",
       "5              NaN                                      NaN   \n",
       "\n",
       "Title   'Round Midnight (1986)  'Til There Was You (1997)  'burbs, The (1989)  \\\n",
       "userId                                                                          \n",
       "1                          NaN                        NaN                 NaN   \n",
       "2                          NaN                        NaN                 NaN   \n",
       "3                          NaN                        NaN                 NaN   \n",
       "4                          NaN                        NaN                 NaN   \n",
       "5                          NaN                        NaN                 NaN   \n",
       "\n",
       "Title   'night Mother (1986)  (500) Days of Summer (2009)  \\\n",
       "userId                                                      \n",
       "1                        NaN                          NaN   \n",
       "2                        NaN                          NaN   \n",
       "3                        NaN                          NaN   \n",
       "4                        NaN                          NaN   \n",
       "5                        NaN                          NaN   \n",
       "\n",
       "Title   *batteries not included (1987)  ...And Justice for All (1979)  \\\n",
       "userId                                                                  \n",
       "1                                  NaN                            NaN   \n",
       "2                                  NaN                            NaN   \n",
       "3                                  NaN                            NaN   \n",
       "4                                  NaN                            NaN   \n",
       "5                                  NaN                            NaN   \n",
       "\n",
       "Title   10 (1979)  ...  [REC] (2007)  [REC]² (2009)  [REC]³ 3 Génesis (2012)  \\\n",
       "userId             ...                                                         \n",
       "1             NaN  ...           NaN            NaN                      NaN   \n",
       "2             NaN  ...           NaN            NaN                      NaN   \n",
       "3             NaN  ...           NaN            NaN                      NaN   \n",
       "4             NaN  ...           NaN            NaN                      NaN   \n",
       "5             NaN  ...           NaN            NaN                      NaN   \n",
       "\n",
       "userId                                              \n",
       "1                            NaN              NaN   \n",
       "2                            NaN              NaN   \n",
       "3                            NaN              NaN   \n",
       "4                            NaN              NaN   \n",
       "5                            NaN              NaN   \n",
       "\n",
       "Title   loudQUIETloud: A Film About the Pixies (2006)  xXx (2002)  \\\n",
       "userId                                                              \n",
       "1                                                 NaN         NaN   \n",
       "2                                                 NaN         NaN   \n",
       "3                                                 NaN         NaN   \n",
       "4                                                 NaN         NaN   \n",
       "5                                                 NaN         NaN   \n",
       "\n",
       "Title   xXx: State of the Union (2005)  ¡Three Amigos! (1986)  \\\n",
       "userId                                                          \n",
       "1                                  NaN                    NaN   \n",
       "2                                  NaN                    NaN   \n",
       "3                                  NaN                    NaN   \n",
       "4                                  NaN                    NaN   \n",
       "5                                  NaN                    NaN   \n",
       "\n",
       "Title   À nous la liberté (Freedom for Us) (1931)  \n",
       "userId                                             \n",
       "1                                             NaN  \n",
       "2                                             NaN  \n",
       "3                                             NaN  \n",
       "4                                             NaN  \n",
       "5                                             NaN  \n",
       "\n",
       "[5 rows x 10323 columns]"
      ]
     },
     "execution_count": 60,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "user_ratings = rating_jn.pivot_table(index=['userId'], columns=['Title'], values='rating')\n",
    "user_ratings.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 61,
   "id": "f4f68c1f",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th>Title</th>\n",
       "      <th>'71 (2014)</th>\n",
       "      <th>'Hellboy': The Seeds of Creation (2004)</th>\n",
       "      <th>'Round Midnight (1986)</th>\n",
       "      <th>'Til There Was You (1997)</th>\n",
       "      <th>'burbs, The (1989)</th>\n",
       "      <th>'night Mother (1986)</th>\n",
       "      <th>(500) Days of Summer (2009)</th>\n",
       "      <th>*batteries not included (1987)</th>\n",
       "      <th>...And Justice for All (1979)</th>\n",
       "      <th>10 (1979)</th>\n",
       "      <th>...</th>\n",
       "      <th>[REC] (2007)</th>\n",
       "      <th>[REC]² (2009)</th>\n",
       "      <th>[REC]³ 3 Génesis (2012)</th>\n",
       "      <th>a/k/a Tommy Chong (2005)</th>\n",
       "      <th>eXistenZ (1999)</th>\n",
       "      <th>loudQUIETloud: A Film About the Pixies (2006)</th>\n",
       "      <th>xXx (2002)</th>\n",
       "      <th>xXx: State of the Union (2005)</th>\n",
       "      <th>¡Three Amigos! (1986)</th>\n",
       "      <th>À nous la liberté (Freedom for Us) (1931)</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>userId</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows × 10323 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "Title   '71 (2014)  'Hellboy': The Seeds of Creation (2004)  \\\n",
       "userId                                                        \n",
       "1              NaN                                      NaN   \n",
       "2              NaN                                      NaN   \n",
       "3              NaN                                      NaN   \n",
       "4              NaN                                      NaN   \n",
       "5              NaN                                      NaN   \n",
       "\n",
       "Title   'Round Midnight (1986)  'Til There Was You (1997)  'burbs, The (1989)  \\\n",
       "userId                                                                          \n",
       "1                          NaN                        NaN                 NaN   \n",
       "2                          NaN                        NaN                 NaN   \n",
       "3                          NaN                        NaN                 NaN   \n",
       "4                          NaN                        NaN                 NaN   \n",
       "5                          NaN                        NaN                 NaN   \n",
       "\n",
       "Title   'night Mother (1986)  (500) Days of Summer (2009)  \\\n",
       "userId                                                      \n",
       "1                        NaN                          NaN   \n",
       "2                        NaN                          NaN   \n",
       "3                        NaN                          NaN   \n",
       "4                        NaN                          NaN   \n",
       "5                        NaN                          NaN   \n",
       "\n",
       "Title   *batteries not included (1987)  ...And Justice for All (1979)  \\\n",
       "userId                                                                  \n",
       "1                                  NaN                            NaN   \n",
       "2                                  NaN                            NaN   \n",
       "3                                  NaN                            NaN   \n",
       "4                                  NaN                            NaN   \n",
       "5                                  NaN                            NaN   \n",
       "\n",
       "Title   10 (1979)  ...  [REC] (2007)  [REC]² (2009)  [REC]³ 3 Génesis (2012)  \\\n",
       "userId             ...                                                         \n",
       "1             NaN  ...           NaN            NaN                      NaN   \n",
       "2             NaN  ...           NaN            NaN                      NaN   \n",
       "3             NaN  ...           NaN            NaN                      NaN   \n",
       "4             NaN  ...           NaN            NaN                      NaN   \n",
       "5             NaN  ...           NaN            NaN                      NaN   \n",
       "\n",
       "Title   a/k/a Tommy Chong (2005)  eXistenZ (1999)  \\\n",
       "userId                                              \n",
       "1                            NaN              NaN   \n",
       "2                            NaN              NaN   \n",
       "3                            NaN              NaN   \n",
       "4                            NaN              NaN   \n",
       "5                            NaN              NaN   \n",
       "\n",
       "Title   loudQUIETloud: A Film About the Pixies (2006)  xXx (2002)  \\\n",
       "userId                                                              \n",
       "1                                                 NaN         NaN   \n",
       "2                                                 NaN         NaN   \n",
       "3                                                 NaN         NaN   \n",
       "4                                                 NaN         NaN   \n",
       "5                                                 NaN         NaN   \n",
       "\n",
       "Title   xXx: State of the Union (2005)  ¡Three Amigos! (1986)  \\\n",
       "userId                                                          \n",
       "1                                  NaN                    NaN   \n",
       "2                                  NaN                    NaN   \n",
       "3                                  NaN                    NaN   \n",
       "4                                  NaN                    NaN   \n",
       "5                                  NaN                    NaN   \n",
       "\n",
       "Title   À nous la liberté (Freedom for Us) (1931)  \n",
       "userId                                             \n",
       "1                                             NaN  \n",
       "2                                             NaN  \n",
       "3                                             NaN  \n",
       "4                                             NaN  \n",
       "5                                             NaN  \n",
       "\n",
       "[5 rows x 10323 columns]"
      ]
     },
     "execution_count": 61,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "user_ratings = rating_jn.pivot_table(index=['userId'], columns=['Title'], values='rating')\n",
    "user_ratings.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "0e8e9261",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": 62,
   "id": "bcaf37ea",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th>Title</th>\n",
       "      <th>'71 (2014)</th>\n",
       "      <th>'Hellboy': The Seeds of Creation (2004)</th>\n",
       "      <th>'Round Midnight (1986)</th>\n",
       "      <th>'Til There Was You (1997)</th>\n",
       "      <th>'burbs, The (1989)</th>\n",
       "      <th>'night Mother (1986)</th>\n",
       "      <th>(500) Days of Summer (2009)</th>\n",
       "      <th>*batteries not included (1987)</th>\n",
       "      <th>...And Justice for All (1979)</th>\n",
       "      <th>10 (1979)</th>\n",
       "      <th>...</th>\n",
       "      <th>[REC] (2007)</th>\n",
       "      <th>[REC]² (2009)</th>\n",
       "      <th>[REC]³ 3 Génesis (2012)</th>\n",
       "      <th>a/k/a Tommy Chong (2005)</th>\n",
       "      <th>eXistenZ (1999)</th>\n",
       "      <th>loudQUIETloud: A Film About the Pixies (2006)</th>\n",
       "      <th>xXx (2002)</th>\n",
       "      <th>xXx: State of the Union (2005)</th>\n",
       "      <th>¡Three Amigos! (1986)</th>\n",
       "      <th>À nous la liberté (Freedom for Us) (1931)</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>userId</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>659</th>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>662</th>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>665</th>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>666</th>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>668</th>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>2.5</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>3.0</td>\n",
       "      <td>2.5</td>\n",
       "      <td>...</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.5</td>\n",
       "      <td>0.5</td>\n",
       "      <td>0.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>3.5</td>\n",
       "      <td>0.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>3.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>258 rows × 10323 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "Title   '71 (2014)  'Hellboy': The Seeds of Creation (2004)  \\\n",
       "userId                                                        \n",
       "1              0.0                                      0.0   \n",
       "4              0.0                                      0.0   \n",
       "7              0.0                                      0.0   \n",
       "9              0.0                                      0.0   \n",
       "17             0.0                                      0.0   \n",
       "...            ...                                      ...   \n",
       "659            0.0                                      0.0   \n",
       "662            0.0                                      0.0   \n",
       "665            0.0                                      0.0   \n",
       "666            0.0                                      0.0   \n",
       "668            0.0                                      0.0   \n",
       "\n",
       "Title   'Round Midnight (1986)  'Til There Was You (1997)  'burbs, The (1989)  \\\n",
       "userId                                                                          \n",
       "1                          0.0                        0.0                 0.0   \n",
       "4                          0.0                        0.0                 0.0   \n",
       "7                          0.0                        0.0                 0.0   \n",
       "9                          0.0                        0.0                 0.0   \n",
       "17                         0.0                        0.0                 0.0   \n",
       "...                        ...                        ...                 ...   \n",
       "659                        0.0                        0.0                 0.0   \n",
       "662                        0.0                        0.0                 0.0   \n",
       "665                        0.0                        0.0                 0.0   \n",
       "666                        0.0                        0.0                 0.0   \n",
       "668                        2.5                        0.0                 0.0   \n",
       "\n",
       "Title   'night Mother (1986)  (500) Days of Summer (2009)  \\\n",
       "userId                                                      \n",
       "1                        0.0                          0.0   \n",
       "4                        0.0                          0.0   \n",
       "7                        0.0                          0.0   \n",
       "9                        0.0                          0.0   \n",
       "17                       0.0                          0.0   \n",
       "...                      ...                          ...   \n",
       "659                      0.0                          0.0   \n",
       "662                      0.0                          0.0   \n",
       "665                      0.0                          0.0   \n",
       "666                      0.0                          0.0   \n",
       "668                      0.0                          2.0   \n",
       "\n",
       "Title   *batteries not included (1987)  ...And Justice for All (1979)  \\\n",
       "userId                                                                  \n",
       "1                                  0.0                            0.0   \n",
       "4                                  0.0                            0.0   \n",
       "7                                  0.0                            0.0   \n",
       "9                                  0.0                            0.0   \n",
       "17                                 0.0                            0.0   \n",
       "...                                ...                            ...   \n",
       "659                                0.0                            0.0   \n",
       "662                                0.0                            0.0   \n",
       "665                                0.0                            0.0   \n",
       "666                                0.0                            0.0   \n",
       "668                                0.0                            3.0   \n",
       "\n",
       "Title   10 (1979)  ...  [REC] (2007)  [REC]² (2009)  [REC]³ 3 Génesis (2012)  \\\n",
       "userId             ...                                                         \n",
       "1             0.0  ...           0.0            0.0                      0.0   \n",
       "4             0.0  ...           0.0            0.0                      0.0   \n",
       "7             0.0  ...           0.0            0.0                      0.0   \n",
       "9             0.0  ...           0.0            0.0                      0.0   \n",
       "17            0.0  ...           0.0            0.0                      0.0   \n",
       "...           ...  ...           ...            ...                      ...   \n",
       "659           0.0  ...           0.0            0.0                      0.0   \n",
       "662           0.0  ...           0.0            0.0                      0.0   \n",
       "665           0.0  ...           0.0            0.0                      0.0   \n",
       "666           0.0  ...           0.0            0.0                      0.0   \n",
       "668           2.5  ...           0.0            1.5                      0.5   \n",
       "\n",
       "Title   a/k/a Tommy Chong (2005)  eXistenZ (1999)  \\\n",
       "userId                                              \n",
       "1                            0.0              0.0   \n",
       "4                            0.0              0.0   \n",
       "7                            0.0              0.0   \n",
       "9                            0.0              0.0   \n",
       "17                           0.0              0.0   \n",
       "...                          ...              ...   \n",
       "659                          0.0              0.0   \n",
       "662                          0.0              0.0   \n",
       "665                          0.0              0.0   \n",
       "666                          0.0              5.0   \n",
       "668                          0.0              2.0   \n",
       "\n",
       "Title   loudQUIETloud: A Film About the Pixies (2006)  xXx (2002)  \\\n",
       "userId                                                              \n",
       "1                                                 0.0         0.0   \n",
       "4                                                 0.0         0.0   \n",
       "7                                                 0.0         0.0   \n",
       "9                                                 0.0         0.0   \n",
       "17                                                0.0         0.0   \n",
       "...                                               ...         ...   \n",
       "659                                               0.0         0.0   \n",
       "662                                               0.0         0.0   \n",
       "665                                               0.0         0.0   \n",
       "666                                               0.0         0.0   \n",
       "668                                               0.0         3.5   \n",
       "\n",
       "Title   xXx: State of the Union (2005)  ¡Three Amigos! (1986)  \\\n",
       "userId                                                          \n",
       "1                                  0.0                    0.0   \n",
       "4                                  0.0                    0.0   \n",
       "7                                  0.0                    0.0   \n",
       "9                                  0.0                    0.0   \n",
       "17                                 0.0                    0.0   \n",
       "...                                ...                    ...   \n",
       "659                                0.0                    0.0   \n",
       "662                                0.0                    0.0   \n",
       "665                                0.0                    0.0   \n",
       "666                                0.0                    0.0   \n",
       "668                                0.0                    2.0   \n",
       "\n",
       "Title   À nous la liberté (Freedom for Us) (1931)  \n",
       "userId                                             \n",
       "1                                             0.0  \n",
       "4                                             0.0  \n",
       "7                                             0.0  \n",
       "9                                             0.0  \n",
       "17                                            0.0  \n",
       "...                                           ...  \n",
       "659                                           0.0  \n",
       "662                                           0.0  \n",
       "665                                           0.0  \n",
       "666                                           0.0  \n",
       "668                                           3.0  \n",
       "\n",
       "[258 rows x 10323 columns]"
      ]
     },
     "execution_count": 62,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "## drop all moives who have less than 100 users who have rated it and fill remaining NaN with 0\n",
    "user_ratings = user_ratings.dropna(thresh = 100, axis = 0).fillna (0)\n",
    "user_ratings"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 63,
   "id": "eae1bc14",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th>Title</th>\n",
       "      <th>'71 (2014)</th>\n",
       "      <th>'Hellboy': The Seeds of Creation (2004)</th>\n",
       "      <th>'Round Midnight (1986)</th>\n",
       "      <th>'Til There Was You (1997)</th>\n",
       "      <th>'burbs, The (1989)</th>\n",
       "      <th>'night Mother (1986)</th>\n",
       "      <th>(500) Days of Summer (2009)</th>\n",
       "      <th>*batteries not included (1987)</th>\n",
       "      <th>...And Justice for All (1979)</th>\n",
       "      <th>10 (1979)</th>\n",
       "      <th>...</th>\n",
       "      <th>[REC] (2007)</th>\n",
       "      <th>[REC]² (2009)</th>\n",
       "      <th>[REC]³ 3 Génesis (2012)</th>\n",
       "      <th>a/k/a Tommy Chong (2005)</th>\n",
       "      <th>eXistenZ (1999)</th>\n",
       "      <th>loudQUIETloud: A Film About the Pixies (2006)</th>\n",
       "      <th>xXx (2002)</th>\n",
       "      <th>xXx: State of the Union (2005)</th>\n",
       "      <th>¡Three Amigos! (1986)</th>\n",
       "      <th>À nous la liberté (Freedom for Us) (1931)</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Title</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>'71 (2014)</th>\n",
       "      <td>1.000000</td>\n",
       "      <td>NaN</td>\n",
       "      <td>-0.003891</td>\n",
       "      <td>-0.005458</td>\n",
       "      <td>-0.015478</td>\n",
       "      <td>-0.003891</td>\n",
       "      <td>-0.020032</td>\n",
       "      <td>-0.011043</td>\n",
       "      <td>0.482123</td>\n",
       "      <td>-0.006375</td>\n",
       "      <td>...</td>\n",
       "      <td>-0.009444</td>\n",
       "      <td>-0.007112</td>\n",
       "      <td>-0.004405</td>\n",
       "      <td>-0.003891</td>\n",
       "      <td>-0.019020</td>\n",
       "      <td>-0.003891</td>\n",
       "      <td>0.162172</td>\n",
       "      <td>-0.009159</td>\n",
       "      <td>0.093784</td>\n",
       "      <td>-0.003891</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>'Hellboy': The Seeds of Creation (2004)</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>'Round Midnight (1986)</th>\n",
       "      <td>-0.003891</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>-0.005458</td>\n",
       "      <td>-0.015478</td>\n",
       "      <td>-0.003891</td>\n",
       "      <td>0.082819</td>\n",
       "      <td>-0.011043</td>\n",
       "      <td>0.359210</td>\n",
       "      <td>0.678912</td>\n",
       "      <td>...</td>\n",
       "      <td>-0.009444</td>\n",
       "      <td>0.222236</td>\n",
       "      <td>0.137644</td>\n",
       "      <td>-0.003891</td>\n",
       "      <td>0.095100</td>\n",
       "      <td>-0.003891</td>\n",
       "      <td>0.233817</td>\n",
       "      <td>-0.009159</td>\n",
       "      <td>0.093784</td>\n",
       "      <td>1.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>'Til There Was You (1997)</th>\n",
       "      <td>-0.005458</td>\n",
       "      <td>NaN</td>\n",
       "      <td>-0.005458</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>-0.021710</td>\n",
       "      <td>-0.005458</td>\n",
       "      <td>-0.028097</td>\n",
       "      <td>-0.015489</td>\n",
       "      <td>-0.013364</td>\n",
       "      <td>-0.008941</td>\n",
       "      <td>...</td>\n",
       "      <td>-0.013247</td>\n",
       "      <td>-0.009975</td>\n",
       "      <td>-0.006178</td>\n",
       "      <td>-0.005458</td>\n",
       "      <td>-0.026678</td>\n",
       "      <td>-0.005458</td>\n",
       "      <td>-0.023759</td>\n",
       "      <td>-0.012846</td>\n",
       "      <td>-0.031621</td>\n",
       "      <td>-0.005458</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>'burbs, The (1989)</th>\n",
       "      <td>-0.015478</td>\n",
       "      <td>NaN</td>\n",
       "      <td>-0.015478</td>\n",
       "      <td>-0.021710</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>-0.015478</td>\n",
       "      <td>-0.033193</td>\n",
       "      <td>0.215687</td>\n",
       "      <td>0.050994</td>\n",
       "      <td>-0.025358</td>\n",
       "      <td>...</td>\n",
       "      <td>0.036924</td>\n",
       "      <td>-0.028288</td>\n",
       "      <td>-0.017521</td>\n",
       "      <td>-0.015478</td>\n",
       "      <td>0.205195</td>\n",
       "      <td>-0.015478</td>\n",
       "      <td>0.069356</td>\n",
       "      <td>-0.036431</td>\n",
       "      <td>0.132341</td>\n",
       "      <td>-0.015478</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>loudQUIETloud: A Film About the Pixies (2006)</th>\n",
       "      <td>-0.003891</td>\n",
       "      <td>NaN</td>\n",
       "      <td>-0.003891</td>\n",
       "      <td>-0.005458</td>\n",
       "      <td>-0.015478</td>\n",
       "      <td>-0.003891</td>\n",
       "      <td>0.237096</td>\n",
       "      <td>-0.011043</td>\n",
       "      <td>-0.009528</td>\n",
       "      <td>-0.006375</td>\n",
       "      <td>...</td>\n",
       "      <td>-0.009444</td>\n",
       "      <td>-0.007112</td>\n",
       "      <td>-0.004405</td>\n",
       "      <td>-0.003891</td>\n",
       "      <td>-0.019020</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>-0.016939</td>\n",
       "      <td>-0.009159</td>\n",
       "      <td>-0.022544</td>\n",
       "      <td>-0.003891</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>xXx (2002)</th>\n",
       "      <td>0.162172</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.233817</td>\n",
       "      <td>-0.023759</td>\n",
       "      <td>0.069356</td>\n",
       "      <td>0.197995</td>\n",
       "      <td>0.245853</td>\n",
       "      <td>-0.048074</td>\n",
       "      <td>0.305011</td>\n",
       "      <td>0.290143</td>\n",
       "      <td>...</td>\n",
       "      <td>0.093085</td>\n",
       "      <td>0.026328</td>\n",
       "      <td>0.016307</td>\n",
       "      <td>0.233817</td>\n",
       "      <td>0.121827</td>\n",
       "      <td>-0.016939</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.345581</td>\n",
       "      <td>0.082425</td>\n",
       "      <td>0.233817</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>xXx: State of the Union (2005)</th>\n",
       "      <td>-0.009159</td>\n",
       "      <td>NaN</td>\n",
       "      <td>-0.009159</td>\n",
       "      <td>-0.012846</td>\n",
       "      <td>-0.036431</td>\n",
       "      <td>-0.009159</td>\n",
       "      <td>0.242491</td>\n",
       "      <td>-0.025992</td>\n",
       "      <td>0.142892</td>\n",
       "      <td>-0.015005</td>\n",
       "      <td>...</td>\n",
       "      <td>0.138071</td>\n",
       "      <td>-0.016739</td>\n",
       "      <td>-0.010367</td>\n",
       "      <td>0.497184</td>\n",
       "      <td>0.151895</td>\n",
       "      <td>-0.009159</td>\n",
       "      <td>0.345581</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.005610</td>\n",
       "      <td>-0.009159</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>¡Three Amigos! (1986)</th>\n",
       "      <td>0.093784</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0.093784</td>\n",
       "      <td>-0.031621</td>\n",
       "      <td>0.132341</td>\n",
       "      <td>0.093784</td>\n",
       "      <td>0.018016</td>\n",
       "      <td>0.121724</td>\n",
       "      <td>0.172680</td>\n",
       "      <td>0.121884</td>\n",
       "      <td>...</td>\n",
       "      <td>-0.054718</td>\n",
       "      <td>-0.014627</td>\n",
       "      <td>-0.009060</td>\n",
       "      <td>-0.022544</td>\n",
       "      <td>0.126179</td>\n",
       "      <td>-0.022544</td>\n",
       "      <td>0.082425</td>\n",
       "      <td>0.005610</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.093784</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>À nous la liberté (Freedom for Us) (1931)</th>\n",
       "      <td>-0.003891</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>-0.005458</td>\n",
       "      <td>-0.015478</td>\n",
       "      <td>-0.003891</td>\n",
       "      <td>0.082819</td>\n",
       "      <td>-0.011043</td>\n",
       "      <td>0.359210</td>\n",
       "      <td>0.678912</td>\n",
       "      <td>...</td>\n",
       "      <td>-0.009444</td>\n",
       "      <td>0.222236</td>\n",
       "      <td>0.137644</td>\n",
       "      <td>-0.003891</td>\n",
       "      <td>0.095100</td>\n",
       "      <td>-0.003891</td>\n",
       "      <td>0.233817</td>\n",
       "      <td>-0.009159</td>\n",
       "      <td>0.093784</td>\n",
       "      <td>1.000000</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>10323 rows × 10323 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "Title                                          '71 (2014)  \\\n",
       "Title                                                       \n",
       "'71 (2014)                                       1.000000   \n",
       "'Hellboy': The Seeds of Creation (2004)               NaN   \n",
       "'Round Midnight (1986)                          -0.003891   \n",
       "'Til There Was You (1997)                       -0.005458   \n",
       "'burbs, The (1989)                              -0.015478   \n",
       "...                                                   ...   \n",
       "loudQUIETloud: A Film About the Pixies (2006)   -0.003891   \n",
       "xXx (2002)                                       0.162172   \n",
       "xXx: State of the Union (2005)                  -0.009159   \n",
       "¡Three Amigos! (1986)                            0.093784   \n",
       "À nous la liberté (Freedom for Us) (1931)       -0.003891   \n",
       "\n",
       "Title                                          'Hellboy': The Seeds of Creation (2004)  \\\n",
       "Title                                                                                    \n",
       "'71 (2014)                                                                         NaN   \n",
       "'Hellboy': The Seeds of Creation (2004)                                            NaN   \n",
       "'Round Midnight (1986)                                                             NaN   \n",
       "'Til There Was You (1997)                                                          NaN   \n",
       "'burbs, The (1989)                                                                 NaN   \n",
       "...                                                                                ...   \n",
       "loudQUIETloud: A Film About the Pixies (2006)                                      NaN   \n",
       "xXx (2002)                                                                         NaN   \n",
       "xXx: State of the Union (2005)                                                     NaN   \n",
       "¡Three Amigos! (1986)                                                              NaN   \n",
       "À nous la liberté (Freedom for Us) (1931)                                          NaN   \n",
       "\n",
       "Title                                          'Round Midnight (1986)  \\\n",
       "Title                                                                   \n",
       "'71 (2014)                                                  -0.003891   \n",
       "'Hellboy': The Seeds of Creation (2004)                           NaN   \n",
       "'Round Midnight (1986)                                       1.000000   \n",
       "'Til There Was You (1997)                                   -0.005458   \n",
       "'burbs, The (1989)                                          -0.015478   \n",
       "...                                                               ...   \n",
       "loudQUIETloud: A Film About the Pixies (2006)               -0.003891   \n",
       "xXx (2002)                                                   0.233817   \n",
       "xXx: State of the Union (2005)                              -0.009159   \n",
       "¡Three Amigos! (1986)                                        0.093784   \n",
       "À nous la liberté (Freedom for Us) (1931)                    1.000000   \n",
       "\n",
       "Title                                          'Til There Was You (1997)  \\\n",
       "Title                                                                      \n",
       "'71 (2014)                                                     -0.005458   \n",
       "'Hellboy': The Seeds of Creation (2004)                              NaN   \n",
       "'Round Midnight (1986)                                         -0.005458   \n",
       "'Til There Was You (1997)                                       1.000000   \n",
       "'burbs, The (1989)                                             -0.021710   \n",
       "...                                                                  ...   \n",
       "loudQUIETloud: A Film About the Pixies (2006)                  -0.005458   \n",
       "xXx (2002)                                                     -0.023759   \n",
       "xXx: State of the Union (2005)                                 -0.012846   \n",
       "¡Three Amigos! (1986)                                          -0.031621   \n",
       "À nous la liberté (Freedom for Us) (1931)                      -0.005458   \n",
       "\n",
       "Title                                          'burbs, The (1989)  \\\n",
       "Title                                                               \n",
       "'71 (2014)                                              -0.015478   \n",
       "'Hellboy': The Seeds of Creation (2004)                       NaN   \n",
       "'Round Midnight (1986)                                  -0.015478   \n",
       "'Til There Was You (1997)                               -0.021710   \n",
       "'burbs, The (1989)                                       1.000000   \n",
       "...                                                           ...   \n",
       "loudQUIETloud: A Film About the Pixies (2006)           -0.015478   \n",
       "xXx (2002)                                               0.069356   \n",
       "xXx: State of the Union (2005)                          -0.036431   \n",
       "¡Three Amigos! (1986)                                    0.132341   \n",
       "À nous la liberté (Freedom for Us) (1931)               -0.015478   \n",
       "\n",
       "Title                                          'night Mother (1986)  \\\n",
       "Title                                                                 \n",
       "'71 (2014)                                                -0.003891   \n",
       "'Hellboy': The Seeds of Creation (2004)                         NaN   \n",
       "'Round Midnight (1986)                                    -0.003891   \n",
       "'Til There Was You (1997)                                 -0.005458   \n",
       "'burbs, The (1989)                                        -0.015478   \n",
       "...                                                             ...   \n",
       "loudQUIETloud: A Film About the Pixies (2006)             -0.003891   \n",
       "xXx (2002)                                                 0.197995   \n",
       "xXx: State of the Union (2005)                            -0.009159   \n",
       "¡Three Amigos! (1986)                                      0.093784   \n",
       "À nous la liberté (Freedom for Us) (1931)                 -0.003891   \n",
       "\n",
       "Title                                          (500) Days of Summer (2009)  \\\n",
       "Title                                                                        \n",
       "'71 (2014)                                                       -0.020032   \n",
       "'Hellboy': The Seeds of Creation (2004)                                NaN   \n",
       "'Round Midnight (1986)                                            0.082819   \n",
       "'Til There Was You (1997)                                        -0.028097   \n",
       "'burbs, The (1989)                                               -0.033193   \n",
       "...                                                                    ...   \n",
       "loudQUIETloud: A Film About the Pixies (2006)                     0.237096   \n",
       "xXx (2002)                                                        0.245853   \n",
       "xXx: State of the Union (2005)                                    0.242491   \n",
       "¡Three Amigos! (1986)                                             0.018016   \n",
       "À nous la liberté (Freedom for Us) (1931)                         0.082819   \n",
       "\n",
       "Title                                          *batteries not included (1987)  \\\n",
       "Title                                                                           \n",
       "'71 (2014)                                                          -0.011043   \n",
       "'Hellboy': The Seeds of Creation (2004)                                   NaN   \n",
       "'Round Midnight (1986)                                              -0.011043   \n",
       "'Til There Was You (1997)                                           -0.015489   \n",
       "'burbs, The (1989)                                                   0.215687   \n",
       "...                                                                       ...   \n",
       "loudQUIETloud: A Film About the Pixies (2006)                       -0.011043   \n",
       "xXx (2002)                                                          -0.048074   \n",
       "xXx: State of the Union (2005)                                      -0.025992   \n",
       "¡Three Amigos! (1986)                                                0.121724   \n",
       "À nous la liberté (Freedom for Us) (1931)                           -0.011043   \n",
       "\n",
       "Title                                          ...And Justice for All (1979)  \\\n",
       "Title                                                                          \n",
       "'71 (2014)                                                          0.482123   \n",
       "'Hellboy': The Seeds of Creation (2004)                                  NaN   \n",
       "'Round Midnight (1986)                                              0.359210   \n",
       "'Til There Was You (1997)                                          -0.013364   \n",
       "'burbs, The (1989)                                                  0.050994   \n",
       "...                                                                      ...   \n",
       "loudQUIETloud: A Film About the Pixies (2006)                      -0.009528   \n",
       "xXx (2002)                                                          0.305011   \n",
       "xXx: State of the Union (2005)                                      0.142892   \n",
       "¡Three Amigos! (1986)                                               0.172680   \n",
       "À nous la liberté (Freedom for Us) (1931)                           0.359210   \n",
       "\n",
       "Title                                          10 (1979)  ...  [REC] (2007)  \\\n",
       "Title                                                     ...                 \n",
       "'71 (2014)                                     -0.006375  ...     -0.009444   \n",
       "'Hellboy': The Seeds of Creation (2004)              NaN  ...           NaN   \n",
       "'Round Midnight (1986)                          0.678912  ...     -0.009444   \n",
       "'Til There Was You (1997)                      -0.008941  ...     -0.013247   \n",
       "'burbs, The (1989)                             -0.025358  ...      0.036924   \n",
       "...                                                  ...  ...           ...   \n",
       "loudQUIETloud: A Film About the Pixies (2006)  -0.006375  ...     -0.009444   \n",
       "xXx (2002)                                      0.290143  ...      0.093085   \n",
       "xXx: State of the Union (2005)                 -0.015005  ...      0.138071   \n",
       "¡Three Amigos! (1986)                           0.121884  ...     -0.054718   \n",
       "À nous la liberté (Freedom for Us) (1931)       0.678912  ...     -0.009444   \n",
       "\n",
       "Title                                          [REC]² (2009)  \\\n",
       "Title                                                          \n",
       "'71 (2014)                                         -0.007112   \n",
       "'Hellboy': The Seeds of Creation (2004)                  NaN   \n",
       "'Round Midnight (1986)                              0.222236   \n",
       "'Til There Was You (1997)                          -0.009975   \n",
       "'burbs, The (1989)                                 -0.028288   \n",
       "...                                                      ...   \n",
       "loudQUIETloud: A Film About the Pixies (2006)      -0.007112   \n",
       "xXx (2002)                                          0.026328   \n",
       "xXx: State of the Union (2005)                     -0.016739   \n",
       "¡Three Amigos! (1986)                              -0.014627   \n",
       "À nous la liberté (Freedom for Us) (1931)           0.222236   \n",
       "\n",
       "Title                                          [REC]³ 3 Génesis (2012)  \\\n",
       "Title                                                                    \n",
       "'71 (2014)                                                   -0.004405   \n",
       "'Hellboy': The Seeds of Creation (2004)                            NaN   \n",
       "'Round Midnight (1986)                                        0.137644   \n",
       "'Til There Was You (1997)                                    -0.006178   \n",
       "'burbs, The (1989)                                           -0.017521   \n",
       "...                                                                ...   \n",
       "loudQUIETloud: A Film About the Pixies (2006)                -0.004405   \n",
       "xXx (2002)                                                    0.016307   \n",
       "xXx: State of the Union (2005)                               -0.010367   \n",
       "¡Three Amigos! (1986)                                        -0.009060   \n",
       "À nous la liberté (Freedom for Us) (1931)                     0.137644   \n",
       "\n",
       "Title                                          a/k/a Tommy Chong (2005)  \\\n",
       "Title                                                                     \n",
       "'71 (2014)                                                    -0.003891   \n",
       "'Hellboy': The Seeds of Creation (2004)                             NaN   \n",
       "'Round Midnight (1986)                                        -0.003891   \n",
       "'Til There Was You (1997)                                     -0.005458   \n",
       "'burbs, The (1989)                                            -0.015478   \n",
       "...                                                                 ...   \n",
       "loudQUIETloud: A Film About the Pixies (2006)                 -0.003891   \n",
       "xXx (2002)                                                     0.233817   \n",
       "xXx: State of the Union (2005)                                 0.497184   \n",
       "¡Three Amigos! (1986)                                         -0.022544   \n",
       "À nous la liberté (Freedom for Us) (1931)                     -0.003891   \n",
       "\n",
       "Title                                          eXistenZ (1999)  \\\n",
       "Title                                                            \n",
       "'71 (2014)                                           -0.019020   \n",
       "'Hellboy': The Seeds of Creation (2004)                    NaN   \n",
       "'Round Midnight (1986)                                0.095100   \n",
       "'Til There Was You (1997)                            -0.026678   \n",
       "'burbs, The (1989)                                    0.205195   \n",
       "...                                                        ...   \n",
       "loudQUIETloud: A Film About the Pixies (2006)        -0.019020   \n",
       "xXx (2002)                                            0.121827   \n",
       "xXx: State of the Union (2005)                        0.151895   \n",
       "¡Three Amigos! (1986)                                 0.126179   \n",
       "À nous la liberté (Freedom for Us) (1931)             0.095100   \n",
       "\n",
       "Title                                          loudQUIETloud: A Film About the Pixies (2006)  \\\n",
       "Title                                                                                          \n",
       "'71 (2014)                                                                         -0.003891   \n",
       "'Hellboy': The Seeds of Creation (2004)                                                  NaN   \n",
       "'Round Midnight (1986)                                                             -0.003891   \n",
       "'Til There Was You (1997)                                                          -0.005458   \n",
       "'burbs, The (1989)                                                                 -0.015478   \n",
       "...                                                                                      ...   \n",
       "loudQUIETloud: A Film About the Pixies (2006)                                       1.000000   \n",
       "xXx (2002)                                                                         -0.016939   \n",
       "xXx: State of the Union (2005)                                                     -0.009159   \n",
       "¡Three Amigos! (1986)                                                              -0.022544   \n",
       "À nous la liberté (Freedom for Us) (1931)                                          -0.003891   \n",
       "\n",
       "Title                                          xXx (2002)  \\\n",
       "Title                                                       \n",
       "'71 (2014)                                       0.162172   \n",
       "'Hellboy': The Seeds of Creation (2004)               NaN   \n",
       "'Round Midnight (1986)                           0.233817   \n",
       "'Til There Was You (1997)                       -0.023759   \n",
       "'burbs, The (1989)                               0.069356   \n",
       "...                                                   ...   \n",
       "loudQUIETloud: A Film About the Pixies (2006)   -0.016939   \n",
       "xXx (2002)                                       1.000000   \n",
       "xXx: State of the Union (2005)                   0.345581   \n",
       "¡Three Amigos! (1986)                            0.082425   \n",
       "À nous la liberté (Freedom for Us) (1931)        0.233817   \n",
       "\n",
       "Title                                          xXx: State of the Union (2005)  \\\n",
       "Title                                                                           \n",
       "'71 (2014)                                                          -0.009159   \n",
       "'Hellboy': The Seeds of Creation (2004)                                   NaN   \n",
       "'Round Midnight (1986)                                              -0.009159   \n",
       "'Til There Was You (1997)                                           -0.012846   \n",
       "'burbs, The (1989)                                                  -0.036431   \n",
       "...                                                                       ...   \n",
       "loudQUIETloud: A Film About the Pixies (2006)                       -0.009159   \n",
       "xXx (2002)                                                           0.345581   \n",
       "xXx: State of the Union (2005)                                       1.000000   \n",
       "¡Three Amigos! (1986)                                                0.005610   \n",
       "À nous la liberté (Freedom for Us) (1931)                           -0.009159   \n",
       "\n",
       "Title                                          ¡Three Amigos! (1986)  \\\n",
       "Title                                                                  \n",
       "'71 (2014)                                                  0.093784   \n",
       "'Hellboy': The Seeds of Creation (2004)                          NaN   \n",
       "'Round Midnight (1986)                                      0.093784   \n",
       "'Til There Was You (1997)                                  -0.031621   \n",
       "'burbs, The (1989)                                          0.132341   \n",
       "...                                                              ...   \n",
       "loudQUIETloud: A Film About the Pixies (2006)              -0.022544   \n",
       "xXx (2002)                                                  0.082425   \n",
       "xXx: State of the Union (2005)                              0.005610   \n",
       "¡Three Amigos! (1986)                                       1.000000   \n",
       "À nous la liberté (Freedom for Us) (1931)                   0.093784   \n",
       "\n",
       "Title                                          À nous la liberté (Freedom for Us) (1931)  \n",
       "Title                                                                                     \n",
       "'71 (2014)                                                                     -0.003891  \n",
       "'Hellboy': The Seeds of Creation (2004)                                              NaN  \n",
       "'Round Midnight (1986)                                                          1.000000  \n",
       "'Til There Was You (1997)                                                      -0.005458  \n",
       "'burbs, The (1989)                                                             -0.015478  \n",
       "...                                                                                  ...  \n",
       "loudQUIETloud: A Film About the Pixies (2006)                                  -0.003891  \n",
       "xXx (2002)                                                                      0.233817  \n",
       "xXx: State of the Union (2005)                                                 -0.009159  \n",
       "¡Three Amigos! (1986)                                                           0.093784  \n",
       "À nous la liberté (Freedom for Us) (1931)                                       1.000000  \n",
       "\n",
       "[10323 rows x 10323 columns]"
      ]
     },
     "execution_count": 63,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#Creating a similarity matrix to understand how closely related this movies are \n",
    "user_item_similarity_df = user_ratings.corr(method = 'pearson')\n",
    "user_item_similarity_df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 64,
   "id": "54055509",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Title\n",
      "Casino (1995)                                                                                             4.000000\n",
      "Goodfellas (1990)                                                                                         1.882004\n",
      "Donnie Brasco (1997)                                                                                      1.714333\n",
      "Carlito's Way (1993)                                                                                      1.615818\n",
      "Clerks (1994)                                                                                             1.603785\n",
      "                                                                                                            ...   \n",
      "Whatever (1998)                                                                                                NaN\n",
      "Wonderland (1999)                                                                                              NaN\n",
      "Young and Prodigious T.S. Spivet, The (L'extravagant voyage du jeune et prodigieux T.S. Spivet) (2013)         NaN\n",
      "Yours, Mine and Ours (1968)                                                                                    NaN\n",
      "Yours, Mine and Ours (2005)                                                                                    NaN\n",
      "Name: Casino (1995), Length: 10323, dtype: float64\n"
     ]
    }
   ],
   "source": [
    "def get_similar_movies(movie_name, user_ratings):\n",
    "    similar_score = user_item_similarity_df[movie_name] * user_ratings\n",
    "    similar_score = similar_score.sort_values(ascending=False)\n",
    "    \n",
    "    return similar_score\n",
    "print(get_similar_movies(\"Casino (1995)\", 4.0 ))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 65,
   "id": "b6eb2659",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/var/folders/yw/s7bgm2n16zjcst5gwwfbrr4c0000gn/T/ipykernel_9978/1712960772.py:6: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  similar_movies = similar_movies.append(get_similar_movies(movie,rating))\n",
      "/var/folders/yw/s7bgm2n16zjcst5gwwfbrr4c0000gn/T/ipykernel_9978/1712960772.py:6: FutureWarning: The frame.append method is deprecated and will be removed from pandas in a future version. Use pandas.concat instead.\n",
      "  similar_movies = similar_movies.append(get_similar_movies(movie,rating))\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th>Title</th>\n",
       "      <th>Casablanca (1942)</th>\n",
       "      <th>Maltese Falcon, The (1941)</th>\n",
       "      <th>African Queen, The (1951)</th>\n",
       "      <th>Psycho (1960)</th>\n",
       "      <th>Gone with the Wind (1939)</th>\n",
       "      <th>Sunset Blvd. (a.k.a. Sunset Boulevard) (1950)</th>\n",
       "      <th>Wizard of Oz, The (1939)</th>\n",
       "      <th>Bonnie and Clyde (1967)</th>\n",
       "      <th>Treasure of the Sierra Madre, The (1948)</th>\n",
       "      <th>Vertigo (1958)</th>\n",
       "      <th>...</th>\n",
       "      <th>Two Much (1995)</th>\n",
       "      <th>Uncommon Valor (1983)</th>\n",
       "      <th>Unhook the Stars (1996)</th>\n",
       "      <th>Walk in the Sun, A (1945)</th>\n",
       "      <th>Watcher in the Woods, The (1980)</th>\n",
       "      <th>Whatever (1998)</th>\n",
       "      <th>Wonderland (1999)</th>\n",
       "      <th>Young and Prodigious T.S. Spivet, The (L'extravagant voyage du jeune et prodigieux T.S. Spivet) (2013)</th>\n",
       "      <th>Yours, Mine and Ours (1968)</th>\n",
       "      <th>Yours, Mine and Ours (2005)</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>Casablanca (1942)</th>\n",
       "      <td>5.000000</td>\n",
       "      <td>2.673825</td>\n",
       "      <td>2.510604</td>\n",
       "      <td>2.440870</td>\n",
       "      <td>2.382207</td>\n",
       "      <td>2.349948</td>\n",
       "      <td>2.245682</td>\n",
       "      <td>2.175066</td>\n",
       "      <td>2.157038</td>\n",
       "      <td>2.083164</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Rosencrantz and Guildenstern Are Dead (1990)</th>\n",
       "      <td>0.207575</td>\n",
       "      <td>0.448007</td>\n",
       "      <td>0.568378</td>\n",
       "      <td>0.129721</td>\n",
       "      <td>0.189480</td>\n",
       "      <td>-0.014485</td>\n",
       "      <td>0.202576</td>\n",
       "      <td>0.555998</td>\n",
       "      <td>0.509556</td>\n",
       "      <td>0.365724</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>2 rows × 10323 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "Title                                         Casablanca (1942)  \\\n",
       "Casablanca (1942)                                      5.000000   \n",
       "Rosencrantz and Guildenstern Are Dead (1990)           0.207575   \n",
       "\n",
       "Title                                         Maltese Falcon, The (1941)  \\\n",
       "Casablanca (1942)                                               2.673825   \n",
       "Rosencrantz and Guildenstern Are Dead (1990)                    0.448007   \n",
       "\n",
       "Title                                         African Queen, The (1951)  \\\n",
       "Casablanca (1942)                                              2.510604   \n",
       "Rosencrantz and Guildenstern Are Dead (1990)                   0.568378   \n",
       "\n",
       "Title                                         Psycho (1960)  \\\n",
       "Casablanca (1942)                                  2.440870   \n",
       "Rosencrantz and Guildenstern Are Dead (1990)       0.129721   \n",
       "\n",
       "Title                                         Gone with the Wind (1939)  \\\n",
       "Casablanca (1942)                                              2.382207   \n",
       "Rosencrantz and Guildenstern Are Dead (1990)                   0.189480   \n",
       "\n",
       "Title                                         Sunset Blvd. (a.k.a. Sunset Boulevard) (1950)  \\\n",
       "Casablanca (1942)                                                                  2.349948   \n",
       "Rosencrantz and Guildenstern Are Dead (1990)                                      -0.014485   \n",
       "\n",
       "Title                                         Wizard of Oz, The (1939)  \\\n",
       "Casablanca (1942)                                             2.245682   \n",
       "Rosencrantz and Guildenstern Are Dead (1990)                  0.202576   \n",
       "\n",
       "Title                                         Bonnie and Clyde (1967)  \\\n",
       "Casablanca (1942)                                            2.175066   \n",
       "Rosencrantz and Guildenstern Are Dead (1990)                 0.555998   \n",
       "\n",
       "Title                                         Treasure of the Sierra Madre, The (1948)  \\\n",
       "Casablanca (1942)                                                             2.157038   \n",
       "Rosencrantz and Guildenstern Are Dead (1990)                                  0.509556   \n",
       "\n",
       "Title                                         Vertigo (1958)  ...  \\\n",
       "Casablanca (1942)                                   2.083164  ...   \n",
       "Rosencrantz and Guildenstern Are Dead (1990)        0.365724  ...   \n",
       "\n",
       "Title                                         Two Much (1995)  \\\n",
       "Casablanca (1942)                                         NaN   \n",
       "Rosencrantz and Guildenstern Are Dead (1990)              NaN   \n",
       "\n",
       "Title                                         Uncommon Valor (1983)  \\\n",
       "Casablanca (1942)                                               NaN   \n",
       "Rosencrantz and Guildenstern Are Dead (1990)                    NaN   \n",
       "\n",
       "Title                                         Unhook the Stars (1996)  \\\n",
       "Casablanca (1942)                                                 NaN   \n",
       "Rosencrantz and Guildenstern Are Dead (1990)                      NaN   \n",
       "\n",
       "Title                                         Walk in the Sun, A (1945)  \\\n",
       "Casablanca (1942)                                                   NaN   \n",
       "Rosencrantz and Guildenstern Are Dead (1990)                        NaN   \n",
       "\n",
       "Title                                         Watcher in the Woods, The (1980)  \\\n",
       "Casablanca (1942)                                                          NaN   \n",
       "Rosencrantz and Guildenstern Are Dead (1990)                               NaN   \n",
       "\n",
       "Title                                         Whatever (1998)  \\\n",
       "Casablanca (1942)                                         NaN   \n",
       "Rosencrantz and Guildenstern Are Dead (1990)              NaN   \n",
       "\n",
       "Title                                         Wonderland (1999)  \\\n",
       "Casablanca (1942)                                           NaN   \n",
       "Rosencrantz and Guildenstern Are Dead (1990)                NaN   \n",
       "\n",
       "Title                                         Young and Prodigious T.S. Spivet, The (L'extravagant voyage du jeune et prodigieux T.S. Spivet) (2013)  \\\n",
       "Casablanca (1942)                                                                           NaN                                                        \n",
       "Rosencrantz and Guildenstern Are Dead (1990)                                                NaN                                                        \n",
       "\n",
       "Title                                         Yours, Mine and Ours (1968)  \\\n",
       "Casablanca (1942)                                                     NaN   \n",
       "Rosencrantz and Guildenstern Are Dead (1990)                          NaN   \n",
       "\n",
       "Title                                         Yours, Mine and Ours (2005)  \n",
       "Casablanca (1942)                                                     NaN  \n",
       "Rosencrantz and Guildenstern Are Dead (1990)                          NaN  \n",
       "\n",
       "[2 rows x 10323 columns]"
      ]
     },
     "execution_count": 65,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "action_lover = [(\"Casablanca (1942)\", 5.0),(\"Rosencrantz and Guildenstern Are Dead (1990)\", 3.5)]\n",
    "\n",
    "similar_movies = pd.DataFrame()\n",
    "\n",
    "for movie,rating in action_lover:\n",
    "    similar_movies = similar_movies.append(get_similar_movies(movie,rating))\n",
    "similar_movies.head()"
   ]
  }
 ],
 "metadata": {
  "celltoolbar": "Raw Cell Format",
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.11.4"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
